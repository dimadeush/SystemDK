<?php/** * Project:   SystemDK: PHP Content Management System * File:      model_admin_feedback.class.php * * @link      http://www.systemsdk.com/ * @copyright 2013 SystemDK * @author    Dmitriy Kravtsov <admin@systemsdk.com> * @package   SystemDK * @version   3.0 */class admin_feedback extends model_base {    public function __construct($registry) {        parent::__construct($registry);        $this->registry->main_class->modules_feedback_autodelete();    }    public function index() {        if(isset($_GET['num_page']) and intval($_GET['num_page']) != 0) {            $num_page = intval($_GET['num_page']);            if($num_page == 0) {                $num_page = 1;            }        } else {            $num_page = 1;        }        $num_string_rows = SYSTEMDK_ADMINROWS_PERPAGE;        $offset = ($num_page - 1) * $num_string_rows;        if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|show|".$num_page."|".$this->registry->language)) {            $sql = "SELECT a.receiver_id,a.receiver_name,a.receiver_email,a.receiver_active,(SELECT count(*) FROM ".PREFIX."_mail_receivers_".$this->registry->sitelang." b) as count_receivers FROM ".PREFIX."_mail_receivers_".$this->registry->sitelang." a order by a.receiver_id DESC";            $result = $this->db->SelectLimit($sql,$num_string_rows,$offset);            if($result) {                if(isset($result->fields['0'])) {                    $numrows = intval($result->fields['0']);                } else {                    $numrows = 0;                }                if($numrows == 0 and $num_page > 1) {                    $this->registry->main_class->database_close();                    header("Location: index.php?path=admin_feedback&func=index&lang=".$this->registry->sitelang);                    exit();                }                if($numrows > 0) {                    while(!$result->EOF) {                        if(!isset($numrows2)) {                            $numrows2 = intval($result->fields['4']);                        }                        $receivers_all[] = array(                            "receiver_id" => intval($result->fields['0']),                            "receiver_name" => $this->registry->main_class->format_htmlspecchars($this->registry->main_class->extracting_data($result->fields['1'])),                            "receiver_email" => $this->registry->main_class->format_htmlspecchars($this->registry->main_class->extracting_data($result->fields['2'])),                            "receiver_active" => intval($result->fields['3'])                        );                        $result->MoveNext();                    }                    $this->registry->main_class->assign("receivers_all",$receivers_all);                    if(isset($numrows2)) {                        $num_pages = @ceil($numrows2 / $num_string_rows);                    } else {                        $num_pages = 0;                    }                    if($num_pages > 1) {                        if($num_page > 1) {                            $prevpage = $num_page - 1;                            $this->registry->main_class->assign("prevpage",$prevpage);                        } else {                            $this->registry->main_class->assign("prevpage","no");                        }                        for($i = 1;$i < $num_pages + 1;$i++) {                            if($i == $num_page) {                                $html[] = array("number" => $i,"param1" => "1");                            } else {                                $pagelink = 5;                                if(($i > $num_page) and ($i < $num_page + $pagelink) or ($i < $num_page) and ($i > $num_page - $pagelink)) {                                    $html[] = array("number" => $i,"param1" => "2");                                }                                if(($i == $num_pages) and ($num_page < $num_pages - $pagelink)) {                                    $html[] = array("number" => $i,"param1" => "3");                                }                                if(($i == 1) and ($num_page > $pagelink + 1)) {                                    $html[] = array("number" => $i,"param1" => "4");                                }                            }                        }                        if($num_page < $num_pages) {                            $nextpage = $num_page + 1;                            $this->registry->main_class->assign("nextpage",$nextpage);                        } else {                            $this->registry->main_class->assign("nextpage","no");                        }                        $this->registry->main_class->assign("html",$html);                        $this->registry->main_class->assign("totalreceivers",$numrows2);                        $this->registry->main_class->assign("num_pages",$num_pages);                    } else {                        $this->registry->main_class->assign("html","no");                    }                } else {                    $this->registry->main_class->assign("receivers_all","no");                    $this->registry->main_class->assign("html","no");                }                if(defined('SYSTEMDK_FEEDBACK_RECEIVER') and SYSTEMDK_FEEDBACK_RECEIVER == "default") {                    $this->registry->main_class->assign("systemdk_feedback_receiver","default");                } else {                    $this->registry->main_class->assign("systemdk_feedback_receiver","list");                }            } else {                $this->registry->main_class->display_theme_adminheader();                $this->registry->main_class->display_theme_adminmain();                $this->registry->main_class->displayadmininfo();                $error_message = $this->db->ErrorMsg();                $error_code = $this->db->ErrorNo();                $error[] = array("code" => $error_code,"message" => $error_message);                $this->registry->main_class->assign("error",$error);                if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|showsqlerror|".$this->registry->language)) {                    $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_MENUFEEDBACK'));                    $this->registry->main_class->assign("feedback_message","sqlerror");                    $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                    $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");                }                $this->registry->main_class->database_close();                $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|showsqlerror|".$this->registry->language);                exit();            }        }        $this->registry->main_class->display_theme_adminheader();        $this->registry->main_class->display_theme_adminmain();        $this->registry->main_class->displayadmininfo();        if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|show|".$num_page."|".$this->registry->language)) {            $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_MENUFEEDBACK'));            $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");            $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_receivers.html");        }        $this->registry->main_class->database_close();        $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|show|".$num_page."|".$this->registry->language);    }    public function feedback_add() {        $this->registry->main_class->display_theme_adminheader();        $this->registry->main_class->display_theme_adminmain();        $this->registry->main_class->displayadmininfo();        if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|add|".$this->registry->language)) {            $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_ADMINISTRATIONADDFEEDBACKPAGETITLE'));            $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");            $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_add.html");        }        $this->registry->main_class->database_close();        $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|add|".$this->registry->language);    }    public function feedback_add_inbase() {        if(isset($_POST['receiver_name'])) {            $receiver_name = trim($_POST['receiver_name']);        }        if(isset($_POST['receiver_email'])) {            $receiver_email = trim($_POST['receiver_email']);        }        if(isset($_POST['receiver_active'])) {            $receiver_active = intval($_POST['receiver_active']);        }        $this->registry->main_class->display_theme_adminheader();        $this->registry->main_class->display_theme_adminmain();        $this->registry->main_class->displayadmininfo();        $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_ADMINISTRATIONADDFEEDBACKPAGETITLE'));        if((!isset($_POST['receiver_name']) or !isset($_POST['receiver_email']) or !isset($_POST['receiver_active'])) or ($receiver_name == "" or $receiver_email == "")) {            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|addnotalldata|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","notalldata");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|addnotalldata|".$this->registry->language);            exit();        }        $receiver_name = $this->registry->main_class->format_striptags($receiver_name);        $receiver_name = $this->registry->main_class->processing_data($receiver_name);        $receiver_email = $this->registry->main_class->format_striptags($receiver_email);        if(!$this->registry->main_class->check_email($this->registry->main_class->checkneed_stripslashes($receiver_email))) {            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|addincorrectemail|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","incorrectemail");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|addincorrectemail|".$this->registry->language);            exit();        }        $receiver_email = $this->registry->main_class->processing_data($receiver_email);        $receiver_id = $this->db->GenID(PREFIX."_mail_receivers_id_".$this->registry->sitelang);        $sql = "INSERT INTO ".PREFIX."_mail_receivers_".$this->registry->sitelang." (receiver_id,receiver_name,receiver_email,receiver_active) VALUES (".$receiver_id.",".$receiver_name.",".$receiver_email.",'".$receiver_active."')";        $result = $this->db->Execute($sql);        if($result === false) {            $error_message = $this->db->ErrorMsg();            $error_code = $this->db->ErrorNo();            $error[] = array("code" => $error_code,"message" => $error_message);        }        if($result === false) {            $this->registry->main_class->assign("error",$error);            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|addsqlerror|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","sqlerror");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|addsqlerror|".$this->registry->language);            exit();        } else {            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|systemadmin|modules|feedback|show");            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|modules|feedback|display");            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|addok|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","addok");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|addok|".$this->registry->language);        }    }    public function feedback_edit() {        if(isset($_GET['receiver_id'])) {            $receiver_id = intval($_GET['receiver_id']);        }        if(!isset($_GET['receiver_id']) or $receiver_id == 0) {            $this->registry->main_class->database_close();            header("Location: index.php?path=admin_feedback&func=index&lang=".$this->registry->sitelang);            exit();        }        $this->registry->main_class->display_theme_adminheader();        $this->registry->main_class->display_theme_adminmain();        $this->registry->main_class->displayadmininfo();        $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_ADMINISTRATIONEDITFEEDBACKPAGETITLE'));        if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|edit|".$receiver_id."|".$this->registry->language)) {            $sql = "SELECT receiver_id,receiver_name,receiver_email,receiver_active FROM ".PREFIX."_mail_receivers_".$this->registry->sitelang." WHERE receiver_id = ".$receiver_id;            $result = $this->db->Execute($sql);            if($result) {                if(isset($result->fields['0'])) {                    $numrows = intval($result->fields['0']);                } else {                    $numrows = 0;                }                if($numrows > 0) {                    $receivers_all[] = array(                        "receiver_id" => intval($result->fields['0']),                        "receiver_name" => $this->registry->main_class->format_htmlspecchars($this->registry->main_class->extracting_data($result->fields['1'])),                        "receiver_email" => $this->registry->main_class->format_htmlspecchars($this->registry->main_class->extracting_data($result->fields['2'])),                        "receiver_active" => intval($result->fields['3'])                    );                    $this->registry->main_class->assign("receivers_all",$receivers_all);                }            } else {                $error_message = $this->db->ErrorMsg();                $error_code = $this->db->ErrorNo();                $error[] = array("code" => $error_code,"message" => $error_message);                $this->registry->main_class->assign("error",$error);                if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editsqlerror|".$this->registry->language)) {                    $this->registry->main_class->assign("feedback_message","sqlerror");                    $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                    $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");                }                $this->registry->main_class->database_close();                $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editsqlerror|".$this->registry->language);                exit();            }            if(!isset($receivers_all)) {                if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editnotfind|".$this->registry->language)) {                    $this->registry->main_class->assign("feedback_message","notfind");                    $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                    $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");                }                $this->registry->main_class->database_close();                $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editnotfind|".$this->registry->language);                exit();            }        }        if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|edit|".$receiver_id."|".$this->registry->language)) {            $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");            $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_edit.html");        }        $this->registry->main_class->database_close();        $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|edit|".$receiver_id."|".$this->registry->language);    }    public function feedback_edit_inbase() {        if(isset($_POST['receiver_id'])) {            $receiver_id = intval($_POST['receiver_id']);        }        if(isset($_POST['receiver_name'])) {            $receiver_name = trim($_POST['receiver_name']);        }        if(isset($_POST['receiver_email'])) {            $receiver_email = trim($_POST['receiver_email']);        }        if(isset($_POST['receiver_active'])) {            $receiver_active = intval($_POST['receiver_active']);        }        $this->registry->main_class->display_theme_adminheader();        $this->registry->main_class->display_theme_adminmain();        $this->registry->main_class->displayadmininfo();        $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_ADMINISTRATIONEDITFEEDBACKPAGETITLE'));        if((!isset($_POST['receiver_id']) or !isset($_POST['receiver_name']) or !isset($_POST['receiver_email']) or !isset($_POST['receiver_active'])) or ($receiver_id == 0 or $receiver_name == "" or $receiver_email == "")) {            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editnotalldata|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","notalldata");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editnotalldata|".$this->registry->language);            exit();        }        $receiver_name = $this->registry->main_class->format_striptags($receiver_name);        $receiver_name = $this->registry->main_class->processing_data($receiver_name);        $receiver_email = $this->registry->main_class->format_striptags($receiver_email);        if(!$this->registry->main_class->check_email($this->registry->main_class->checkneed_stripslashes($receiver_email))) {            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editincorrectemail|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","incorrectemail");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editincorrectemail|".$this->registry->language);            exit();        }        $receiver_email = $this->registry->main_class->processing_data($receiver_email);        $sql = "UPDATE ".PREFIX."_mail_receivers_".$this->registry->sitelang." SET receiver_name = ".$receiver_name.", receiver_email = ".$receiver_email.", receiver_active = '".$receiver_active."' WHERE receiver_id = '".$receiver_id."'";        $result = $this->db->Execute($sql);        $num_result = $this->db->Affected_Rows();        if($result === false) {            $error_message = $this->db->ErrorMsg();            $error_code = $this->db->ErrorNo();            $error[] = array("code" => $error_code,"message" => $error_message);        }        if($result === false) {            $this->registry->main_class->assign("error",$error);            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editsqlerror|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","sqlerror");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editsqlerror|".$this->registry->language);            exit();        } elseif($result !== false and $num_result == 0) {            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editok|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","notsave");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|editok|".$this->registry->language);            exit();        } else {            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|systemadmin|modules|feedback|show");            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|modules|feedback|display");            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|systemadmin|modules|feedback|edit|".$receiver_id);            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|editok|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","editok");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|editok|".$this->registry->language);        }    }    public function feedback_status() {        if(isset($_GET['action'])) {            $action = trim($_GET['action']);        }        if(isset($_GET['receiver_id'])) {            $receiver_id = intval($_GET['receiver_id']);        } else {            $receiver_id = 0;        }        if((!isset($_GET['action']) or !isset($receiver_id)) or ($action == "" or $receiver_id == 0)) {            $this->registry->main_class->database_close();            header("Location: index.php?path=admin_feedback&func=index&lang=".$this->registry->sitelang);            exit();        }        $action = $this->registry->main_class->format_striptags($action);        if($action == "on") {            $sql = "UPDATE ".PREFIX."_mail_receivers_".$this->registry->sitelang." SET receiver_active = '1' WHERE receiver_id = '".$receiver_id."'";            $result = $this->db->Execute($sql);            $this->registry->main_class->assign("feedback_message","on");        } elseif($action == "off") {            $sql = "UPDATE ".PREFIX."_mail_receivers_".$this->registry->sitelang." SET receiver_active = '0' WHERE receiver_id = '".$receiver_id."'";            $result = $this->db->Execute($sql);            $this->registry->main_class->assign("feedback_message","off");        } elseif($action == "delete") {            $sql = "DELETE FROM ".PREFIX."_mail_receivers_".$this->registry->sitelang." WHERE receiver_id='".$receiver_id."'";            $result = $this->db->Execute($sql);            $this->registry->main_class->assign("feedback_message","delete");        } else {            $this->registry->main_class->database_close();            header("Location: index.php?path=admin_feedback&func=index&lang=".$this->registry->sitelang);            exit();        }        if($result) {            $num_result = $this->db->Affected_Rows();        } else {            $error_message = $this->db->ErrorMsg();            $error_code = $this->db->ErrorNo();            $error[] = array("code" => $error_code,"message" => $error_message);        }        $this->registry->main_class->display_theme_adminheader();        $this->registry->main_class->display_theme_adminmain();        $this->registry->main_class->displayadmininfo();        $this->registry->main_class->set_sitemeta($this->registry->main_class->getConfigVars('_MENUFEEDBACK'));        if($result === false) {            $this->registry->main_class->assign("error",$error);            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|statussqlerror|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","sqlerror");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|statussqlerror|".$this->registry->language);            exit();        } elseif($result !== false and $num_result == 0) {            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|statusok|".$this->registry->language)) {                $this->registry->main_class->assign("feedback_message","notsave");                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|error|statusok|".$this->registry->language);            exit();        } else {            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|systemadmin|modules|feedback|show");            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|modules|feedback|display");            $this->registry->main_class->clearCache(null,$this->registry->sitelang."|systemadmin|modules|feedback|edit|".$receiver_id);            if(!$this->registry->main_class->isCached("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|".$action."|ok|".$this->registry->language)) {                $this->registry->main_class->assign("include_center_up","systemadmin/adminup.html");                $this->registry->main_class->assign("include_center","systemadmin/modules/feedback/feedback_messages.html");            }            $this->registry->main_class->database_close();            $this->registry->main_class->display("systemadmin/main.html",$this->registry->sitelang."|systemadmin|modules|feedback|".$action."|ok|".$this->registry->language);        }    }}?>